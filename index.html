<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>çµé­‚è‰²å½©æµ‹è¯• Â· Soul Spectrum</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700;900&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@fontsource/ma-shan-zheng@5.0.3/400.min.css" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --deep:#080510;
  --sf:rgba(255,255,255,0.035);
  --sfh:rgba(255,255,255,0.07);
  --bd:rgba(255,255,255,0.06);
  --bda:rgba(180,160,255,0.4);
  --tx:#ede6ff;
  --txs:#a99cc7;
  --txd:#6b5d85;
  --ac:#b48eff;
  --acg:#d4b8ff;
  --r:18px;--rs:12px;
  --e:cubic-bezier(.4,0,.2,1);
}
html{scroll-behavior:smooth}
body{
  font-family:'Noto Sans SC','PingFang SC','Microsoft YaHei',sans-serif;
  background:var(--deep);color:var(--tx);min-height:100vh;
  overflow-x:hidden;-webkit-font-smoothing:antialiased;
  /* prevent pull-to-refresh on mobile */
  overscroll-behavior-y:contain;
}

/* â•â•â• BG â•â•â• */
canvas#cosmos{position:fixed;inset:0;z-index:0;pointer-events:none}
.orb{position:fixed;border-radius:50%;filter:blur(120px);opacity:.12;pointer-events:none;z-index:0;animation:oF 25s ease-in-out infinite}
.o1{width:700px;height:700px;background:#7c3aed;top:-250px;left:-150px}
.o2{width:500px;height:500px;background:#ec4899;bottom:-200px;right:-100px;animation-delay:-8s}
.o3{width:450px;height:450px;background:#3b82f6;top:50%;left:60%;animation-delay:-16s}
@keyframes oF{0%,100%{transform:translate(0,0) scale(1)}33%{transform:translate(40px,-30px) scale(1.06)}66%{transform:translate(-30px,40px) scale(.94)}}

/* â•â•â• LAYOUT â•â•â• */
.w{max-width:820px;margin:0 auto;padding:0 16px;position:relative;z-index:1}

/* â•â•â• PAGE TRANSITION â•â•â• */
.page{display:none;opacity:0;transition:opacity .4s var(--e)}
.page.active{display:block}
.page.visible{opacity:1}

/* â•â•â• HOME â•â•â• */
.hero{text-align:center;padding:70px 0 40px}
.htag{
  display:inline-block;padding:5px 16px;border:1px solid rgba(180,142,255,.3);
  border-radius:30px;font-size:11px;color:var(--ac);letter-spacing:3px;
  text-transform:uppercase;backdrop-filter:blur(8px);background:rgba(124,58,237,.08);
  margin-bottom:24px;animation:fD .8s var(--e) both;
}
.hero h1{
  font-family:'Ma Shan Zheng','STKaiti',cursive;
  font-size:clamp(2.4rem,7vw,4.5rem);line-height:1.25;margin-bottom:20px;
  background:linear-gradient(135deg,#c4b5fd,#f9a8d4,#93c5fd,#c4b5fd);
  background-size:300% 300%;
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  animation:rS 8s ease infinite, fU .9s var(--e) both;
}
@keyframes rS{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}
.hero>p{font-size:14px;color:var(--txs);max-width:500px;margin:0 auto 32px;line-height:1.85;animation:fU .9s var(--e) .15s both}

.btns{display:flex;justify-content:center;gap:12px;flex-wrap:wrap;animation:fU .9s var(--e) .3s both}
.bgo{
  padding:14px 44px;border:none;border-radius:50px;color:#fff;font-size:16px;font-weight:700;
  cursor:pointer;position:relative;overflow:hidden;font-family:inherit;
  background:linear-gradient(135deg,#7c3aed,#a855f7,#ec4899);background-size:200% 200%;
  transition:all .35s var(--e);-webkit-tap-highlight-color:transparent;
}
.bgo::after{
  content:'';position:absolute;inset:0;
  background:linear-gradient(120deg,transparent 30%,rgba(255,255,255,.18) 50%,transparent 70%);
  background-size:250% 250%;animation:sh 4s ease infinite;
}
@keyframes sh{0%{background-position:-250% 0}100%{background-position:250% 0}}
.bgo:hover{transform:translateY(-3px);box-shadow:0 12px 40px rgba(124,58,237,.45)}
.bgo:active{transform:scale(.97)}

.bgh{
  padding:14px 28px;background:transparent;border:1px solid rgba(180,142,255,.25);
  border-radius:50px;color:var(--ac);font-size:14px;cursor:pointer;
  transition:all .3s var(--e);font-family:inherit;display:flex;align-items:center;gap:7px;
  backdrop-filter:blur(8px);-webkit-tap-highlight-color:transparent;
}
.bgh:hover{background:rgba(124,58,237,.1);border-color:var(--ac);transform:translateY(-2px)}

/* Features */
.feats{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin:40px 0;animation:fU .9s var(--e) .45s both}
.ft{background:var(--sf);border:1px solid var(--bd);border-radius:var(--r);padding:24px 10px;text-align:center;transition:all .3s var(--e);backdrop-filter:blur(16px)}
.ft:hover{background:var(--sfh);transform:translateY(-3px);border-color:var(--bda)}
.fti{font-size:26px;margin-bottom:8px}.ft h3{font-size:12px;font-weight:500}

/* Color preview - compact 2-row */
.cprev{margin:32px 0 48px}
.cprev>h2{text-align:center;font-family:'Ma Shan Zheng','STKaiti',cursive;font-size:24px;color:var(--acg);margin-bottom:22px}
.cgrid{display:flex;flex-wrap:wrap;justify-content:center;gap:10px}
.cit{
  width:calc(33.3% - 8px);min-width:90px;padding:14px 8px;text-align:center;
  background:var(--sf);border:1px solid var(--bd);border-radius:14px;
  backdrop-filter:blur(16px);transition:all .3s var(--e);
}
.cit:hover{transform:translateY(-2px);border-color:var(--bda)}
.csw{width:36px;height:36px;border-radius:50%;margin:0 auto 8px}
.cit h4{font-size:12px;font-weight:500;white-space:nowrap}

/* Info */
.ibox{
  background:var(--sf);border:1px solid var(--bd);border-radius:var(--r);
  padding:36px 28px;text-align:center;margin-bottom:32px;backdrop-filter:blur(16px);
}
.ibox h2{font-family:'Ma Shan Zheng','STKaiti',cursive;font-size:20px;color:var(--acg);margin-bottom:12px}
.ibox p{color:var(--txs);line-height:1.8;font-size:13px;margin-bottom:14px}
.tags{display:flex;justify-content:center;gap:18px;flex-wrap:wrap}
.tag{display:flex;align-items:center;gap:6px;font-size:12px;color:var(--txs)}
.dot{width:6px;height:6px;border-radius:50%}

footer{text-align:center;padding:28px 0;color:var(--txd);font-size:11px;border-top:1px solid var(--bd)}
.credit{font-size:10px;color:var(--txd);margin-top:4px;opacity:.6}

/* â•â•â• QUIZ â•â•â• */
.qh{display:flex;justify-content:space-between;align-items:center;padding:16px 0}
.qbk{background:none;border:none;color:var(--ac);font-size:13px;cursor:pointer;font-family:inherit;-webkit-tap-highlight-color:transparent}
.qn{font-size:13px;font-weight:700;color:var(--ac)}

.pt{width:100%;height:5px;background:rgba(255,255,255,.05);border-radius:3px;overflow:hidden;margin-bottom:32px}
.pf{height:100%;border-radius:3px;position:relative;background:linear-gradient(90deg,#7c3aed,#a855f7,#ec4899);transition:width .5s var(--e)}
.pf::after{content:'';position:absolute;right:0;top:-3px;width:11px;height:11px;background:#ec4899;border-radius:50%;box-shadow:0 0 14px rgba(236,72,153,.7)}

.qc{
  background:var(--sf);border:1px solid var(--bd);border-radius:var(--r);
  padding:36px 28px;backdrop-filter:blur(16px);box-shadow:0 8px 32px rgba(0,0,0,.3);
  animation:sI .35s var(--e);
}
@keyframes sI{from{opacity:0;transform:translateX(24px)}to{opacity:1;transform:translateX(0)}}
.qc h2{text-align:center;font-size:17px;font-weight:700;margin-bottom:28px;line-height:1.55}

.opts{display:flex;flex-direction:column;gap:10px}
.op{
  display:flex;align-items:center;gap:12px;padding:14px 18px;
  background:rgba(255,255,255,.015);border:1px solid rgba(255,255,255,.07);
  border-radius:var(--rs);color:var(--tx);font-size:14px;
  cursor:pointer;transition:all .25s var(--e);font-family:inherit;text-align:left;width:100%;
  -webkit-tap-highlight-color:transparent;
}
.op:hover{background:rgba(124,58,237,.07);border-color:rgba(124,58,237,.25);transform:translateX(3px)}
.op.pk{background:rgba(124,58,237,.13);border-color:var(--ac);box-shadow:0 0 18px rgba(124,58,237,.12)}
.od{
  width:18px;height:18px;border-radius:50%;border:2px solid rgba(255,255,255,.18);
  flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:all .25s var(--e);
}
.op.pk .od{border-color:var(--ac);background:var(--ac)}
.op.pk .od::after{content:'';width:6px;height:6px;background:#fff;border-radius:50%}

.qnav{display:flex;justify-content:center;margin-top:24px}
.bbk{
  padding:9px 22px;background:transparent;border:1px solid rgba(255,255,255,.08);
  border-radius:50px;color:var(--txs);font-size:12px;cursor:pointer;
  transition:all .25s var(--e);font-family:inherit;-webkit-tap-highlight-color:transparent;
}
.bbk:hover{background:rgba(255,255,255,.04);color:var(--tx)}

/* â•â•â• LOADING â•â•â• */
.ldp{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:80vh;text-align:center}
.ldo{
  width:100px;height:100px;border-radius:50%;position:relative;margin-bottom:32px;
  background:radial-gradient(circle at 35% 35%,var(--ac),#4c1d95);
  animation:ldP 2s ease-in-out infinite;
}
.ldo::before{content:'';position:absolute;inset:-10px;border-radius:50%;border:2px solid transparent;border-top-color:var(--ac);animation:sp 1.4s linear infinite}
.ldo::after{content:'';position:absolute;inset:-20px;border-radius:50%;border:1px solid transparent;border-bottom-color:#f472b6;animation:sp 2.2s linear infinite reverse}
@keyframes ldP{0%,100%{transform:scale(1);box-shadow:0 0 40px rgba(124,58,237,.35)}50%{transform:scale(1.07);box-shadow:0 0 70px rgba(124,58,237,.55)}}
@keyframes sp{to{transform:rotate(360deg)}}
.ldp h2{font-family:'Ma Shan Zheng','STKaiti',cursive;font-size:20px;color:var(--acg);margin-bottom:8px}
.ldp p{color:var(--txd);font-size:13px}
.ld-dots{margin-top:12px}
.ld-dots span{display:inline-block;width:6px;height:6px;border-radius:50%;background:var(--ac);margin:0 3px;animation:ldDot 1.4s ease-in-out infinite}
.ld-dots span:nth-child(2){animation-delay:.2s}
.ld-dots span:nth-child(3){animation-delay:.4s}
@keyframes ldDot{0%,80%,100%{transform:scale(.4);opacity:.3}40%{transform:scale(1);opacity:1}}

/* â•â•â• RESULT â•â•â• */
.rtop{text-align:center;padding:50px 0 20px}
.rbadge{
  display:inline-block;padding:5px 20px;border-radius:28px;font-size:12px;font-weight:700;
  letter-spacing:3px;margin-bottom:12px;border:1px solid var(--ac);
  background:rgba(124,58,237,.12);color:var(--acg);
}
.rtop h1{
  font-family:'Ma Shan Zheng','STKaiti',cursive;font-size:clamp(1.8rem,5vw,3.2rem);margin-bottom:8px;
}
.rtop .sub{font-size:16px;color:var(--txs)}

/* Ring chart */
.ring-wrap{display:flex;justify-content:center;margin:24px 0 32px}
.ring-box{position:relative;width:200px;height:200px}
.ring-box canvas{width:200px;height:200px}
.ring-center{
  position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;
}
.ring-emoji{font-size:36px}
.ring-pct{font-size:22px;font-weight:900;margin-top:2px}
.ring-label{font-size:11px;color:var(--txd);margin-top:2px}

.rc{
  background:var(--sf);border:1px solid var(--bd);border-radius:var(--r);
  padding:28px 24px;margin-bottom:16px;backdrop-filter:blur(16px);box-shadow:0 8px 32px rgba(0,0,0,.25);
}
.rc h3{font-size:16px;margin-bottom:12px;color:var(--acg);display:flex;align-items:center;gap:8px}
.rc p{color:var(--txs);line-height:1.85;font-size:13px}

/* Spectrum bars */
.dg{margin-bottom:18px}.dg:last-child{margin-bottom:0}
.dl{display:flex;justify-content:space-between;margin-bottom:5px;font-size:12px}
.dlf,.dlr{color:var(--txs)}.dlon{color:var(--acg);font-weight:700}
.dt{height:6px;background:rgba(255,255,255,.05);border-radius:3px;overflow:hidden}
.df{height:100%;border-radius:3px;transition:width 1.2s var(--e)}

.tg{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.ti{padding:10px 12px;background:rgba(124,58,237,.06);border:1px solid rgba(124,58,237,.12);border-radius:var(--rs);font-size:12px;text-align:center}

.cpr{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.cp{padding:14px 10px;background:rgba(255,255,255,.02);border:1px solid var(--bd);border-radius:var(--rs);text-align:center}
.cp b{display:block;font-size:14px;color:var(--acg);margin-bottom:2px}
.cp span{font-size:10px;color:var(--txd)}

/* Share card */
.share-section{margin:28px 0}
.share-section h3{text-align:center;font-size:15px;color:var(--acg);margin-bottom:16px}
#shareCard{
  width:100%;max-width:420px;margin:0 auto;border-radius:var(--r);overflow:hidden;
  display:block;
}
.share-tip{text-align:center;font-size:11px;color:var(--txd);margin-top:10px}

.racts{display:flex;justify-content:center;gap:12px;margin:28px 0;flex-wrap:wrap}

/* â•â•â• HISTORY â•â•â• */
.hh{display:flex;justify-content:space-between;align-items:center;padding:24px 0 16px}
.hh h2{font-family:'Ma Shan Zheng','STKaiti',cursive;font-size:20px;color:var(--acg)}
.hl{margin-bottom:32px}
.hi{
  background:var(--sf);border:1px solid var(--bd);border-radius:var(--r);
  padding:18px 20px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center;
  backdrop-filter:blur(16px);transition:all .25s var(--e);cursor:pointer;
  -webkit-tap-highlight-color:transparent;
}
.hi:hover{background:var(--sfh);border-color:var(--bda)}
.hin h3{font-size:14px;margin-bottom:2px}.hin p{font-size:11px;color:var(--txd)}
.hit{font-size:12px;font-weight:700;padding:4px 12px;border-radius:20px;border:1px solid var(--bd)}
.eh{text-align:center;padding:60px 0;color:var(--txd)}
.ehi{font-size:38px;margin-bottom:12px}

.clr-btn{background:none;border:1px solid rgba(239,68,68,.3);color:#f87171;font-size:11px;padding:6px 14px;border-radius:20px;cursor:pointer;font-family:inherit;transition:all .2s}
.clr-btn:hover{background:rgba(239,68,68,.1)}

/* â•â•â• PASSWORD GATE â•â•â• */
.pwd-page{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:85vh;text-align:center;padding:40px 0}
.pwd-orb{
  width:80px;height:80px;border-radius:50%;margin-bottom:28px;
  background:radial-gradient(circle at 35% 35%,var(--ac),#4c1d95);
  box-shadow:0 0 50px rgba(124,58,237,.35);
  animation:ldP 3s ease-in-out infinite;
}
.pwd-page h1{
  font-family:'Ma Shan Zheng','STKaiti',cursive;font-size:32px;margin-bottom:8px;
  background:linear-gradient(135deg,#c4b5fd,#f9a8d4,#93c5fd);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}
.pwd-page>p{color:var(--txs);font-size:14px;margin-bottom:32px}
.pwd-box{width:100%;max-width:300px}
.pwd-input{
  width:100%;padding:14px 18px;background:rgba(255,255,255,.05);
  border:1px solid rgba(255,255,255,.1);border-radius:var(--rs);
  color:var(--tx);font-size:16px;font-family:inherit;text-align:center;
  outline:none;transition:border-color .3s;letter-spacing:2px;
}
.pwd-input:focus{border-color:var(--ac)}
.pwd-input::placeholder{color:var(--txd);letter-spacing:0}
.pwd-err{color:#f87171;font-size:13px;margin-top:12px;min-height:20px}
.pwd-err.ok{color:#34d399}
.pwd-tip{color:var(--txd);font-size:12px;margin-top:24px}

/* â•â•â• ANIM â•â•â• */
@keyframes fD{from{opacity:0;transform:translateY(-16px)}to{opacity:1;transform:translateY(0)}}
@keyframes fU{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}

/* â•â•â• RESPONSIVE â•â•â• */
@media(max-width:640px){
  .feats{grid-template-columns:repeat(2,1fr);gap:8px}
  .ft{padding:18px 8px}
  .qc{padding:28px 18px}
  .rc{padding:22px 18px}
  .tg{grid-template-columns:repeat(2,1fr)}
  .hero{padding:50px 0 30px}
  .hero h1{font-size:2.2rem}
}
</style>
</head>
<body>

<canvas id="cosmos"></canvas>
<div class="orb o1"></div><div class="orb o2"></div><div class="orb o3"></div>

<!-- â•â•â• PASSWORD GATE â•â•â• -->
<div class="page active visible" id="pgPwd">
<div class="w">
  <div class="pwd-page">
    <div class="pwd-orb"></div>
    <h1>çµé­‚è‰²å½©æµ‹è¯•</h1>
    <p>å®Œæ•´ç‰ˆ Â· è¯·è¾“å…¥æ¿€æ´»å¯†ç </p>
    <div class="pwd-box">
      <input type="text" id="pwdInput" class="pwd-input" placeholder="è¯·è¾“å…¥å¯†ç " maxlength="20" autocomplete="off">
      <button class="bgo" onclick="checkPwd()" id="pwdBtn" style="width:100%;margin-top:12px">âœ¦ æ¿€æ´»</button>
    </div>
    <div id="pwdErr" class="pwd-err"></div>
    <div class="pwd-tip">å¯†ç ç”±ã€Œç¬¬å…­æ„Ÿå®éªŒå®¤ã€åº—é“ºè´­ä¹°åè·å–</div>
  </div>
</div>
</div>

<!-- â•â•â• HOME â•â•â• -->
<div class="page" id="pgHome">
<div class="w">
  <div class="hero">
    <div class="htag">Soul Spectrum</div>
    <h1>ä½ çš„çµé­‚æ˜¯ä»€ä¹ˆé¢œè‰²ï¼Ÿ</h1>
    <p>æ¯ä¸ªçµé­‚éƒ½æ•£å‘ç€ç‹¬ç‰¹çš„è‰²å½©å…‰èŠ’ã€‚é€šè¿‡30é“æ·±å…¥å†…å¿ƒçš„æƒ…å¢ƒé¢˜ç›®ï¼Œè§£è¯»ä½ æ½œæ„è¯†ä¸­çš„è‰²å½©é¢‘ç‡ï¼Œæ­ç¤ºçµé­‚æ·±å¤„æœ€çœŸå®çš„é¢œè‰²å¯†ç ã€‚</p>
    <div class="btns">
      <button class="bgo" onclick="startQuiz()">âœ¦ å¼€å§‹æ¢ç´¢</button>
      <button class="bgh" onclick="navTo('pgHist')">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
        å†å²è®°å½•
      </button>
    </div>
  </div>

  <div class="feats">
    <div class="ft"><div class="fti">ğŸ”®</div><h3>æ·±å±‚æ½œæ„è¯†æ¢æµ‹</h3></div>
    <div class="ft"><div class="fti">ğŸŒˆ</div><h3>9ç§çµé­‚è‰²å½©</h3></div>
    <div class="ft"><div class="fti">ğŸ’</div><h3>æ€§æ ¼ç‰¹è´¨è§£æ</h3></div>
    <div class="ft"><div class="fti">âœ¨</div><h3>è‰²å½©å…±é¸£é…å¯¹</h3></div>
  </div>

  <div class="cprev">
    <h2>ä¹ç§çµé­‚è‰²å½©</h2>
    <div class="cgrid" id="cgrid"></div>
  </div>

  <div class="ibox">
    <h2>æµ‹è¯•è¯´æ˜</h2>
    <p>30é“ç²¾å¿ƒè®¾è®¡çš„æƒ…å¢ƒé¢˜ç›®ï¼Œä»æƒ…æ„Ÿå€¾å‘ã€ç¤¾äº¤é£æ ¼ã€æ€ç»´æ¨¡å¼ã€å†…å¿ƒæ¸´æœ›å››ä¸ªç»´åº¦å…¨é¢æ‰«æä½ çš„çµé­‚è‰²å½©é¢‘ç‡ã€‚æµ‹è¯•çº¦éœ€5åˆ†é’Ÿï¼Œè¯·è·Ÿéšç›´è§‰é€‰æ‹©ã€‚</p>
    <div class="tags">
      <span class="tag"><span class="dot" style="background:#8B5CF6"></span>æƒ…æ„Ÿå…±é¸£</span>
      <span class="tag"><span class="dot" style="background:#F59E0B"></span>æ½œæ„è¯†æ¢ç´¢</span>
      <span class="tag"><span class="dot" style="background:#EC4899"></span>è‰²å½©è§£ç </span>
    </div>
  </div>
  <footer>Â© 2025 Soul Spectrum Â· çµé­‚è‰²å½©æµ‹è¯•<div class="credit">â€” æµ‹è¯•ä»…ä¾›å¨±ä¹å‚è€ƒ â€”</div></footer>
</div>
</div>

<!-- â•â•â• QUIZ â•â•â• -->
<div class="page" id="pgQuiz">
<div class="w">
  <div class="qh">
    <button class="qbk" onclick="navTo('pgHome')">â† è¿”å›ä¸»é¡µ</button>
    <span class="qn" id="qNum"></span>
  </div>
  <div class="pt"><div class="pf" id="pf" style="width:3%"></div></div>
  <div id="qArea"></div>
  <div class="qnav" id="qNav" style="display:none">
    <button class="bbk" onclick="prevQ()">â€¹ ä¸Šä¸€é¢˜</button>
  </div>
</div>
</div>

<!-- â•â•â• LOADING â•â•â• -->
<div class="page" id="pgLoad">
<div class="w">
  <div class="ldp">
    <div class="ldo"></div>
    <h2>æ­£åœ¨è§£è¯»ä½ çš„çµé­‚è‰²å½©â€¦</h2>
    <p>æ˜Ÿå…‰æ­£åœ¨æ±‡èš</p>
    <div class="ld-dots"><span></span><span></span><span></span></div>
  </div>
</div>
</div>

<!-- â•â•â• RESULT â•â•â• -->
<div class="page" id="pgResult"><div class="w" id="resC"></div></div>

<!-- â•â•â• HISTORY â•â•â• -->
<div class="page" id="pgHist">
<div class="w">
  <div class="hh">
    <h2>å†å²è®°å½•</h2>
    <div style="display:flex;gap:8px;align-items:center">
      <button class="clr-btn" onclick="clearHist()">æ¸…ç©ºè®°å½•</button>
      <button class="qbk" onclick="navTo('pgHome')">â† è¿”å›</button>
    </div>
  </div>
  <div id="hList" class="hl"></div>
</div>
</div>

<script>
// â•â•â• STAR CANVAS â•â•â•
(function(){
  const c=document.getElementById('cosmos'),x=c.getContext('2d');let stars=[];
  function resize(){c.width=innerWidth;c.height=innerHeight;init()}
  function init(){stars=[];for(let i=0;i<160;i++)stars.push({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*1.1+.3,a:Math.random(),s:Math.random()*.002+.0005,d:Math.random()>.5?1:-1})}
  function draw(){x.clearRect(0,0,c.width,c.height);stars.forEach(s=>{s.a+=s.s*s.d;if(s.a>=1||s.a<=0)s.d*=-1;x.beginPath();x.arc(s.x,s.y,s.r,0,Math.PI*2);x.fillStyle=`rgba(220,210,255,${s.a*.5})`;x.fill()});requestAnimationFrame(draw)}
  resize();draw();addEventListener('resize',resize)
})();

// â•â•â• DEVICE ID & PASSWORD SYSTEM â•â•â•
function getDeviceId(){
  let id;
  try{id=localStorage.getItem('soul_device_id')}catch(e){}
  if(!id){
    id='D'+Date.now().toString(36)+Math.random().toString(36).slice(2,8);
    try{localStorage.setItem('soul_device_id',id)}catch(e){}
  }
  return id;
}

// Check if already unlocked on this device
let unlocked=false;
try{unlocked=localStorage.getItem('soul_unlocked')==='true'}catch(e){}
if(unlocked){
  document.getElementById('pgPwd').classList.remove('active','visible');
  document.getElementById('pgHome').classList.add('active','visible');
}

// Enter key support
document.getElementById('pwdInput').addEventListener('keydown',function(e){
  if(e.key==='Enter')checkPwd();
});

async function checkPwd(){
  const input=document.getElementById('pwdInput').value.trim();
  const err=document.getElementById('pwdErr');
  const btn=document.getElementById('pwdBtn');
  if(!input){err.className='pwd-err';err.textContent='è¯·è¾“å…¥å¯†ç ';return}

  btn.textContent='éªŒè¯ä¸­â€¦';btn.disabled=true;
  err.textContent='';

  try{
    const res=await fetch('/api/verify',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({code:input,deviceId:getDeviceId()})
    });
    const data=await res.json();
    if(data.ok){
      err.className='pwd-err ok';err.textContent=data.msg;
      try{localStorage.setItem('soul_unlocked','true')}catch(e){}
      setTimeout(()=>navTo('pgHome'),800);
    } else {
      err.className='pwd-err';err.textContent=data.msg;
      document.getElementById('pwdInput').value='';
    }
  }catch(e){
    err.className='pwd-err';err.textContent='ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•';
  }
  btn.textContent='âœ¦ æ¿€æ´»';btn.disabled=false;
}

// â•â•â• QUESTIONS â•â•â•
const Q=[
{q:"æ·±å¤œç‹¬å¤„æ—¶ï¼Œä½ æœ€å¸¸åšçš„äº‹æƒ…æ˜¯ï¼Ÿ",o:[
  {t:"ä»°æœ›æ˜Ÿç©ºï¼Œæ€è€ƒå®‡å®™ä¸äººç”Ÿ",c:{purple:3,blue:1}},
  {t:"å¬éŸ³ä¹ï¼Œæ²‰æµ¸åœ¨æƒ…æ„Ÿä¸–ç•Œé‡Œ",c:{aurora:2,pink:2}},
  {t:"è§„åˆ’æ˜å¤©çš„è¡ŒåŠ¨è®¡åˆ’",c:{gold:2,red:2}},
  {t:"ç¿»çœ‹æœ‹å‹çš„åŠ¨æ€ï¼Œæƒ³å¿µæŸä¸ªäºº",c:{green:2,orange:2}}
]},
{q:"å¦‚æœä½ çš„æƒ…ç»ªæ˜¯ä¸€ç§å¤©æ°”ï¼Œä»Šå¤©æœ€åƒä»€ä¹ˆï¼Ÿ",o:[
  {t:"å¹³é™çš„æœˆå¤œï¼Œæ¸…å†·è€Œæ¾„æ¾ˆ",c:{silver:3,blue:1}},
  {t:"ç»šçƒ‚çš„æ™šéœï¼Œæ¸©æš–åˆæœ‰äº›æ„Ÿä¼¤",c:{orange:2,pink:2}},
  {t:"é›·é›¨å‰çš„é—·çƒ­ï¼Œè“„åŠ¿å¾…å‘",c:{red:3,gold:1}},
  {t:"æ™´æœ—çš„å¾®é£å¤©ï¼Œè½»æ¾è‡ªåœ¨",c:{green:2,aurora:2}}
]},
{q:"æœ‹å‹é‡åˆ°å›°éš¾å‘ä½ æ±‚åŠ©ï¼Œä½ çš„ç¬¬ä¸€ååº”æ˜¯ï¼Ÿ",o:[
  {t:"å…ˆå¸®TAåˆ†æé—®é¢˜çš„æœ¬è´¨åŸå› ",c:{blue:3,purple:1}},
  {t:"å…ˆç»™ä¸€ä¸ªæ¸©æš–çš„æ‹¥æŠ±å†è¯´",c:{pink:3,green:1}},
  {t:"ç«‹åˆ»å¸®TAæƒ³è§£å†³æ–¹æ¡ˆå¹¶è¡ŒåŠ¨",c:{red:2,gold:2}},
  {t:"é™ªåœ¨TAèº«è¾¹ï¼Œå®‰é™å€¾å¬",c:{silver:2,green:2}}
]},
{q:"é€‰æ‹©ä¸€ç§ä½ æœ€æƒ³æ‹¥æœ‰çš„è¶…èƒ½åŠ›ï¼š",o:[
  {t:"è¯»å¿ƒæœ¯â€”â€”æ´æ‚‰æ‰€æœ‰äººçš„æƒ³æ³•",c:{purple:2,silver:2}},
  {t:"æ—¶é—´å€’æµâ€”â€”å›åˆ°çè´µçš„ç¬é—´",c:{blue:3,pink:1}},
  {t:"ç¬é—´ç§»åŠ¨â€”â€”è‡ªç”±å»ä»»ä½•åœ°æ–¹",c:{orange:3,aurora:1}},
  {t:"æ²»æ„ˆä¹‹åŠ›â€”â€”ä¿®å¤æ‰€æœ‰ä¼¤ç—›",c:{green:3,gold:1}}
]},
{q:"ä½ æ›´äº«å—å“ªç§æ—…è¡Œæ–¹å¼ï¼Ÿ",o:[
  {t:"ç‹¬è‡ªèƒŒåŒ…æ—…è¡Œï¼Œä¸è‡ªå·±å¯¹è¯",c:{blue:3,silver:1}},
  {t:"å’Œæœ€äº²å¯†çš„äººä¸€èµ·æ…¢æ—…è¡Œ",c:{pink:2,green:2}},
  {t:"æŒ‘æˆ˜æé™è¿åŠ¨å’Œæ¢é™©",c:{red:3,orange:1}},
  {t:"åœ¨å¼‚å›½è¡—å¤´éšæ„æ¼«æ­¥æ¢ç´¢",c:{aurora:3,gold:1}}
]},
{q:"ä½ åœ¨ä¸€ä¸ªç©ºç™½ç”»å¸ƒå‰ï¼Œä¼šå…ˆç”»ä»€ä¹ˆï¼Ÿ",o:[
  {t:"ä¸€ç‰‡æ·±é‚ƒçš„æ˜Ÿç©º",c:{purple:3,blue:1}},
  {t:"ä¸€æœµæ­£åœ¨ç»½æ”¾çš„èŠ±",c:{green:2,pink:2}},
  {t:"æŠ½è±¡çš„çº¿æ¡å’Œè‰²å—",c:{aurora:2,orange:2}},
  {t:"ä¸€åº§å‘å…‰çš„ç¯å¡”",c:{gold:3,silver:1}}
]},
{q:"åˆ«äººæœ€å¸¸ç”¨å“ªä¸ªè¯å½¢å®¹ä½ ï¼Ÿ",o:[
  {t:"ç¥ç§˜â€”â€”æ€»è®©äººçŒœä¸é€",c:{silver:3,purple:1}},
  {t:"æ¸©æš–â€”â€”åƒå†¬å¤©çš„æš–é˜³",c:{gold:2,pink:2}},
  {t:"æœ‰è¶£â€”â€”å’Œä½ åœ¨ä¸€èµ·ä¸æ— èŠ",c:{orange:3,aurora:1}},
  {t:"å¯é â€”â€”å€¼å¾—ä¿¡èµ–çš„å­˜åœ¨",c:{blue:2,red:2}}
]},
{q:"ä½ æœ€å®³æ€•å¤±å»çš„æ˜¯ä»€ä¹ˆï¼Ÿ",o:[
  {t:"è‡ªç”±â€”â€”ä¸æƒ³è¢«ä»»ä½•äº‹ç‰©æŸç¼š",c:{aurora:3,orange:1}},
  {t:"çˆ±çš„äººâ€”â€”æ„Ÿæƒ…æ˜¯æˆ‘çš„å‘½è„‰",c:{pink:3,gold:1}},
  {t:"è‡ªæˆ‘â€”â€”å®³æ€•è¿·å¤±çœŸæ­£çš„è‡ªå·±",c:{purple:2,silver:2}},
  {t:"æ¢¦æƒ³â€”â€”æ²¡æœ‰ç›®æ ‡å°±æ²¡æœ‰æ„ä¹‰",c:{red:2,gold:2}}
]},
{q:"ä½ åœ¨äººç¾¤ä¸­é€šå¸¸æ‰®æ¼”ä»€ä¹ˆè§’è‰²ï¼Ÿ",o:[
  {t:"è§‚å¯Ÿè€…â€”â€”é»˜é»˜çœ‹é€ä¸€åˆ‡",c:{silver:3,blue:1}},
  {t:"è°ƒå’Œè€…â€”â€”è®©å¤§å®¶å’Œç¦ç›¸å¤„",c:{green:3,pink:1}},
  {t:"å‘èµ·è€…â€”â€”å¸¦åŠ¨æ°”æ°›çš„é‚£ä¸ªäºº",c:{gold:2,orange:2}},
  {t:"å€¾å¬è€…â€”â€”å¤§å®¶éƒ½çˆ±å‘æˆ‘å€¾è¯‰",c:{purple:2,blue:2}}
]},
{q:"å¦‚æœç”Ÿå‘½åªå‰©æœ€åä¸€å¤©ï¼Œä½ ä¼šï¼Ÿ",o:[
  {t:"å»ä¸€ä¸ªæ²¡å»è¿‡çš„åœ°æ–¹çœ‹æ—¥å‡º",c:{orange:3,aurora:1}},
  {t:"å’Œæœ€çˆ±çš„äººå¾…åœ¨ä¸€èµ·",c:{pink:2,green:2}},
  {t:"æŠŠæƒ³è¯´çš„è¯å…¨éƒ½å†™ä¸‹æ¥",c:{purple:3,blue:1}},
  {t:"å®Œæˆä¸€ä»¶ä¸€ç›´æƒ³åšå´æ²¡åšçš„äº‹",c:{red:3,gold:1}}
]},
{q:"é›¨å¤©æ—¶ä½ æœ€å–œæ¬¢åšä»€ä¹ˆï¼Ÿ",o:[
  {t:"çªåœ¨è¢«çªé‡Œçœ‹ä¹¦æˆ–å‘å‘†",c:{blue:3,silver:1}},
  {t:"ç…®ä¸€æ¯çƒ­é¥®ï¼Œæœ›ç€çª—å¤–å‡ºç¥",c:{purple:2,pink:2}},
  {t:"çº¦æœ‹å‹æ¥å®¶é‡Œèšä¼š",c:{gold:3,orange:1}},
  {t:"ç©¿ä¸Šé›¨è¡£å‡ºå»æ·‹é›¨æ•£æ­¥",c:{red:3,aurora:1}}
]},
{q:"ä½ æ›´å®¹æ˜“è¢«å“ªç§éŸ³ä¹æ‰“åŠ¨ï¼Ÿ",o:[
  {t:"ç©ºçµç¼¥ç¼ˆçš„æ°›å›´ç”µå­ä¹",c:{aurora:3,purple:1}},
  {t:"å‚¬äººæ³ªä¸‹çš„é’¢ç´æ›²",c:{silver:2,pink:2}},
  {t:"æ¿€æ˜‚æ¾æ¹ƒçš„æ‘‡æ»šä¹",c:{red:2,orange:2}},
  {t:"æ¸©é¦¨æ²»æ„ˆçš„æ°‘è°£",c:{green:3,gold:1}}
]},
{q:"ä½ è§‰å¾—äººç”Ÿæœ€é‡è¦çš„æ˜¯ä»€ä¹ˆï¼Ÿ",o:[
  {t:"å†…å¿ƒçš„å¹³é™ä¸æ™ºæ…§",c:{silver:3,blue:1}},
  {t:"çˆ±ä¸è¢«çˆ±çš„èƒ½åŠ›",c:{pink:3,green:1}},
  {t:"è‡ªç”±åœ°åšè‡ªå·±",c:{aurora:2,purple:2}},
  {t:"ç•™ä¸‹æœ‰æ„ä¹‰çš„æˆå°±",c:{gold:3,red:1}}
]},
{q:"ä½ æ›´å®¹æ˜“åœ¨ä»€ä¹ˆæ—¶å€™æµæ³ªï¼Ÿ",o:[
  {t:"çœ‹åˆ°ä»¤äººæ„ŸåŠ¨çš„æ•…äº‹æˆ–ç”µå½±",c:{pink:2,blue:2}},
  {t:"ç‹¬å¤„æ—¶çªç„¶æ¶Œä¸Šçš„å­¤ç‹¬æ„Ÿ",c:{purple:3,silver:1}},
  {t:"ä¸ºåˆ«äººçš„é­é‡æ„Ÿåˆ°ä¸å…¬",c:{red:2,gold:2}},
  {t:"å¤§è‡ªç„¶çš„ç¾æ™¯è®©æˆ‘éœ‡æ’¼è½æ³ª",c:{green:2,aurora:2}}
]},
{q:"å¦‚æœä½ æ˜¯ä¸€ç§é¥®å“ï¼Œä½ è§‰å¾—è‡ªå·±æ˜¯ï¼Ÿ",o:[
  {t:"æ‰‹å†²é»‘å’–å•¡â€”â€”è‹¦æ¶©ä¸­æœ‰å±‚æ¬¡",c:{blue:3,silver:1}},
  {t:"ä¸€æ¯çƒ­å¯å¯â€”â€”ç”œèœœæ¸©æš–",c:{gold:2,pink:2}},
  {t:"ä¸€æ¯çƒˆé…’â€”â€”æµ“çƒˆä¸”ä¸Šå¤´",c:{red:3,orange:1}},
  {t:"ä¸€æ¯èŠ±æœèŒ¶â€”â€”æ¸…æ–°è‡ªç„¶",c:{green:2,aurora:2}}
]},
{q:"é€‰ä¸€ä¸ªä½ æœ€æƒ³å±…ä½çš„åœ°æ–¹ï¼š",o:[
  {t:"å±±é—´çš„å¤è€æœ¨å±‹ï¼Œè¿œç¦»å°˜åš£",c:{silver:2,purple:2}},
  {t:"æµ·è¾¹çš„å°é•‡ï¼Œå¬ç€æµªå£°å…¥çœ ",c:{blue:2,green:2}},
  {t:"ç¹åéƒ½å¸‚çš„é¡¶å±‚å…¬å¯“",c:{gold:3,red:1}},
  {t:"å¼€æ»¡é²œèŠ±çš„ä¹¡é—´å°é™¢",c:{orange:3,pink:1}}
]},
{q:"ä½ å¯¹ã€ŒæˆåŠŸã€çš„å®šä¹‰æœ€æ¥è¿‘å“ªä¸ªï¼Ÿ",o:[
  {t:"æ‰¾åˆ°ç”Ÿå‘½çš„æ„ä¹‰å’Œæ™ºæ…§",c:{purple:3,blue:1}},
  {t:"èº«è¾¹æœ‰çˆ±æˆ‘çš„äººå’Œæˆ‘çˆ±çš„äºº",c:{green:3,pink:1}},
  {t:"å®ç°è‡ªå·±è®¾å®šçš„æ¯ä¸€ä¸ªç›®æ ‡",c:{gold:2,red:2}},
  {t:"ä½“éªŒä¸°å¯Œå¤šå½©çš„äººç”Ÿ",c:{orange:3,aurora:1}}
]},
{q:"é¢å¯¹æœªçŸ¥çš„æŒ‘æˆ˜ï¼Œä½ çš„å†…å¿ƒçŠ¶æ€æ˜¯ï¼Ÿ",o:[
  {t:"å†·é™åˆ†æï¼Œç†æ€§åº”å¯¹",c:{blue:3,silver:1}},
  {t:"æœ‰äº›ç´§å¼ ï¼Œä½†ç›¸ä¿¡ä¸€åˆ‡ä¼šå¥½çš„",c:{green:2,pink:2}},
  {t:"å…´å¥‹ï¼è¶ŠæœªçŸ¥è¶Šæƒ³å»æ¢ç´¢",c:{orange:2,red:2}},
  {t:"ç›´è§‰å‘Šè¯‰æˆ‘è¯¥æ€ä¹ˆåš",c:{aurora:3,purple:1}}
]},
{q:"ä½ æœ€çè§†çš„ç«¥å¹´å›å¿†åœºæ™¯æ˜¯ï¼Ÿ",o:[
  {t:"å¤å¤œåœ¨é™¢å­é‡Œæ•°æ˜Ÿæ˜Ÿ",c:{purple:2,silver:2}},
  {t:"å’Œå®¶äººå›´ååœ¨ä¸€èµ·åƒé¥­",c:{pink:2,gold:2}},
  {t:"åœ¨ç”°é‡æˆ–å±±é‡Œè‡ªç”±å¥”è·‘",c:{orange:3,green:1}},
  {t:"ç¬¬ä¸€æ¬¡ç‹¬ç«‹å®ŒæˆæŸä»¶äº‹çš„è‡ªè±ª",c:{red:3,blue:1}}
]},
{q:"ä½ å¸Œæœ›åˆ«äººè®°ä½ä½ çš„æ˜¯ä»€ä¹ˆï¼Ÿ",o:[
  {t:"æˆ‘çš„æ€æƒ³å’Œè§è§£",c:{purple:2,blue:2}},
  {t:"æˆ‘ç»™è¿‡åˆ«äººçš„æ¸©æš–å’Œçˆ±",c:{pink:3,green:1}},
  {t:"æˆ‘åšè¿‡çš„é‚£äº›äº†ä¸èµ·çš„äº‹",c:{gold:2,red:2}},
  {t:"æˆ‘è¿™ä¸ªäººæœ¬èº«çš„ç‹¬ç‰¹å­˜åœ¨",c:{aurora:3,silver:1}}
]},
{q:"å½“ä½ æ„Ÿåˆ°å‹åŠ›å¾ˆå¤§æ—¶ï¼Œä½ ä¼šï¼Ÿ",o:[
  {t:"ä¸€ä¸ªäººå¾…ç€ï¼Œè®©æ€ç»ªè‡ªç„¶æµåŠ¨",c:{blue:3,purple:1}},
  {t:"æ‰¾äº²è¿‘çš„äººèŠèŠï¼Œè·å¾—å®‰æ…°",c:{pink:2,green:2}},
  {t:"è¿åŠ¨æˆ–åšäº›æ¶ˆè€—ä½“åŠ›çš„äº‹",c:{red:3,orange:1}},
  {t:"åšä¸€äº›åˆ›é€ æ€§çš„äº‹æ¥è½¬ç§»æ³¨æ„",c:{aurora:2,gold:2}}
]},
{q:"ä½ æ›´æ„¿æ„æˆä¸ºå“ªç§è‡ªç„¶ç°è±¡ï¼Ÿ",o:[
  {t:"åŒ—æå…‰â€”â€”ç¥ç§˜è€Œç»šçƒ‚",c:{aurora:3,purple:1}},
  {t:"æ˜¥å¤©çš„ç¬¬ä¸€ç¼•é˜³å…‰â€”â€”æ¸©æš–å¸Œæœ›",c:{gold:3,orange:1}},
  {t:"æ·±æµ·ä¸­çš„æš—æµâ€”â€”æ²‰é™è€Œå¼ºå¤§",c:{silver:3,blue:1}},
  {t:"ç››å¼€çš„æ¨±èŠ±é›¨â€”â€”æµªæ¼«çŸ­æš‚",c:{pink:3,red:1}}
]},
{q:"é€‰ä¸€æœ¬ä½ æœ€æƒ³è¯»çš„ä¹¦ï¼š",o:[
  {t:"ä¸€æœ¬å…³äºå®‡å®™å¥¥ç§˜çš„ç§‘æ™®ä¹¦",c:{purple:2,blue:2}},
  {t:"ä¸€éƒ¨å‚¬æ³ªçš„çˆ±æƒ…å°è¯´",c:{pink:2,silver:2}},
  {t:"ä¸€æœ¬æ”¹å˜æ€ç»´çš„å•†ä¸šä¼ è®°",c:{gold:3,red:1}},
  {t:"ä¸€æœ¬èƒŒåŒ…å®¢çš„ç¯çƒæ—…è¡Œæ—¥è®°",c:{orange:3,aurora:1}}
]},
{q:"ä½ è§‰å¾—æœ€èƒ½ä»£è¡¨ã€Œå‹‡æ°”ã€çš„æ˜¯ï¼Ÿ",o:[
  {t:"æ•¢äºé¢å¯¹å†…å¿ƒæœ€æ·±çš„ææƒ§",c:{silver:3,purple:1}},
  {t:"ä¸ºäº†ä¿æŠ¤çˆ±çš„äººä¸é¡¾ä¸€åˆ‡",c:{red:3,pink:1}},
  {t:"åœ¨æ‰€æœ‰äººåå¯¹æ—¶åšæŒè‡ªå·±",c:{gold:2,aurora:2}},
  {t:"æ”¾å¼ƒå®‰å…¨çš„ç”Ÿæ´»å»è¿½é€æ¢¦æƒ³",c:{orange:3,green:1}}
]},
{q:"ä½ å’Œé™Œç”Ÿäººç›¸å¤„çš„æ–¹å¼é€šå¸¸æ˜¯ï¼Ÿ",o:[
  {t:"å…ˆè§‚å¯Ÿï¼Œç¡®è®¤å®‰å…¨åæ…¢æ…¢é è¿‘",c:{silver:2,blue:2}},
  {t:"å¾®ç¬‘ç¤ºå¥½ï¼Œä¸»åŠ¨æ‰¾è¯é¢˜",c:{gold:3,pink:1}},
  {t:"çœ‹ç¼˜åˆ†ï¼Œæœ‰è¶£å°±èŠä¸æœ‰è¶£å°±èµ°",c:{aurora:2,orange:2}},
  {t:"çœŸè¯šå€¾å¬ï¼Œè®©å¯¹æ–¹å…ˆæ‰“å¼€å¿ƒæ‰‰",c:{green:3,purple:1}}
]},
{q:"æ·±å¤œè¾—è½¬éš¾çœ æ—¶ï¼Œä½ è„‘ä¸­æµ®ç°çš„æ˜¯ï¼Ÿ",o:[
  {t:"å¯¹æŸä¸ªæ·±å±‚é—®é¢˜çš„åå¤æ€è€ƒ",c:{purple:3,silver:1}},
  {t:"æŸä¸ªäººçš„è„¸å’ŒæŸæ®µå¯¹è¯çš„å›å¿†",c:{pink:2,blue:2}},
  {t:"æ˜å¤©è¦åšçš„äº‹å’Œæœªæ¥çš„è®¡åˆ’",c:{gold:2,red:2}},
  {t:"å¤©é©¬è¡Œç©ºçš„æƒ³è±¡å’Œåˆ›æ„çµæ„Ÿ",c:{aurora:3,orange:1}}
]},
{q:"å¦‚æœä½ èƒ½ç»™å…¨ä¸–ç•Œä¸€ä¸ªç¤¼ç‰©ï¼Œé‚£ä¼šæ˜¯ï¼Ÿ",o:[
  {t:"æ™ºæ…§â€”â€”è®©æ¯ä¸ªäººçœ‹æ¸…çœŸç›¸",c:{blue:3,silver:1}},
  {t:"çˆ±â€”â€”è®©ä¸–ç•Œä¸å†æœ‰å­¤ç‹¬",c:{green:3,purple:1}},
  {t:"å‹‡æ°”â€”â€”è®©æ¯ä¸ªäººæ•¢äºè¿½æ¢¦",c:{red:3,gold:1}},
  {t:"è‡ªç”±â€”â€”æ‰“ç ´æ‰€æœ‰æŸç¼š",c:{aurora:2,orange:2}}
]},
{q:"ä½ è§‰å¾—è‡ªå·±å†…å¿ƒæ·±å¤„æœ€åƒå“ªç§åŠ¨ç‰©ï¼Ÿ",o:[
  {t:"çŒ«å¤´é¹°â€”â€”å¤œé—´çš„æ™ºè€…",c:{purple:2,silver:2}},
  {t:"å¤©é¹…â€”â€”ä¼˜é›…ä¸”æ·±æƒ…",c:{blue:3,pink:1}},
  {t:"ç‹¼â€”â€”ç‹¬ç«‹è€Œå¿ è¯š",c:{red:2,green:2}},
  {t:"è´è¶â€”â€”ç¾ä¸½è€Œè‡ªç”±",c:{orange:2,aurora:2}}
]},
{q:"åœ¨ä½ å¿ƒä¸­ï¼Œã€Œå¹¸ç¦ã€æ˜¯ä»€ä¹ˆé¢œè‰²çš„ï¼Ÿ",o:[
  {t:"é‡‘è‰²çš„â€”â€”åƒé˜³å…‰æ´’åœ¨è„¸ä¸Š",c:{gold:3,orange:1}},
  {t:"ç²‰è‰²çš„â€”â€”åƒè¢«æŸ”è½¯çš„çˆ±åŒ…å›´",c:{pink:3,aurora:1}},
  {t:"é€æ˜çš„â€”â€”çº¯ç²¹åˆ°æ²¡æœ‰ä»»ä½•æ‚è´¨",c:{silver:3,blue:1}},
  {t:"ç»¿è‰²çš„â€”â€”å®‰å®ã€ç”Ÿé•¿ã€ç”Ÿç”Ÿä¸æ¯",c:{green:3,red:1}}
]},
{q:"æœ€åä¸€é¢˜ï¼šæ­¤åˆ»é—­ä¸Šçœ¼ç›ï¼Œä½ çœ‹åˆ°äº†ä»€ä¹ˆï¼Ÿ",o:[
  {t:"ä¸€ç‰‡æµ©ç€šæ— é™…çš„æ˜Ÿç©º",c:{purple:2,blue:2}},
  {t:"ä¸€æŸæ¸©æš–æŸ”å’Œçš„å…‰èŠ’",c:{gold:2,orange:2}},
  {t:"ä¸€å›¢è·³åŠ¨çš„ç«ç„°",c:{red:3,aurora:1}},
  {t:"ä¸€ç‰‡å®‰é™çš„æ£®æ—æˆ–æµ·æ´‹",c:{green:2,silver:2}}
]}
];

// â•â•â• COLOR RESULTS â•â•â•
const CR={
  purple:{name:"æ˜Ÿè¾°ç´«",em:"ğŸ”®",ti:"ç¥ç§˜çš„çµé­‚å®ˆæœ›è€…",
    co:"#8B5CF6",gr:"linear-gradient(135deg,#7c3aed,#a78bfa)",
    gw:"rgba(139,92,246,.4)",gw2:"rgba(139,92,246,.15)",
    desc:"ä½ çš„çµé­‚æ•£å‘ç€æ·±é‚ƒçš„ç´«è‰²å…‰èŠ’ï¼Œå¦‚åŒå¤œç©ºä¸­æœ€ç¥ç§˜çš„æ˜Ÿäº‘ã€‚ä½ æ‹¥æœ‰è¶…å‡¡çš„ç›´è§‰åŠ›å’Œæ´å¯ŸåŠ›ï¼Œæ€»èƒ½çœ‹åˆ°åˆ«äººçœ‹ä¸åˆ°çš„æœ¬è´¨ã€‚ä½ çƒ­çˆ±æ€è€ƒç”Ÿå‘½çš„æ·±å±‚æ„ä¹‰ï¼Œå¯¹çµæ€§ä¸–ç•Œå……æ»¡å¥½å¥‡ã€‚åœ¨äººç¾¤ä¸­ä½ å¯èƒ½æ˜¾å¾—å®‰é™ï¼Œä½†ä½ çš„å†…å¿ƒå®‡å®™æ¯”ä»»ä½•äººéƒ½è¾½é˜”ã€‚",
    tr:["ç›´è§‰æ•é”","æ€æƒ³æ·±é‚ƒ","ç‹¬ç«‹è‡ªä¸»","è¿½æ±‚çœŸç†","ç¥ç§˜æ°”è´¨","å“²å­¦æ€ç»´"],
    cp:[{n:"æ·±æµ·è“",d:"çµé­‚å…±æŒ¯"},{n:"æœˆå…‰é“¶",d:"æ€æƒ³ç¢°æ’"},{n:"æå…‰å½©",d:"äº’è¡¥å…±ç”Ÿ"}]},
  blue:{name:"æ·±æµ·è“",em:"ğŸŒŠ",ti:"å®é™çš„æ·±é‚ƒæ€è€ƒè€…",
    co:"#3B82F6",gr:"linear-gradient(135deg,#2563eb,#60a5fa)",
    gw:"rgba(59,130,246,.4)",gw2:"rgba(59,130,246,.15)",
    desc:"ä½ çš„çµé­‚åƒæ·±æµ·ä¸€èˆ¬ï¼Œå¹³é™çš„è¡¨é¢ä¸‹è•´å«ç€æ— ç©·çš„åŠ›é‡ä¸æ·±åº¦ã€‚ä½ æ˜¯å¤©ç”Ÿçš„æ€è€ƒè€…å’Œåˆ†æè€…ï¼Œå–„äºç”¨ç†æ€§çš„æ–¹å¼ç†è§£ä¸–ç•Œã€‚ä½ è¿½æ±‚å†…å¿ƒçš„å¹³é™ï¼Œä¸å–œæ¬¢ä¸å¿…è¦çš„å–§åš£ã€‚ä½ çš„å¿ è¯šå’Œå¯é è®©èº«è¾¹çš„äººæ„Ÿåˆ°å®‰å¿ƒï¼Œå¦‚åŒæš—å¤œä¸­æ°¸è¿œäº®ç€çš„ç¯å¡”ã€‚",
    tr:["ç†æ€§å†·é™","å¿ è¯šå¯é ","è¿½æ±‚æ·±åº¦","å†…å¿ƒä¸°å¯Œ","å–„äºåˆ†æ","æƒ…ç»ªç¨³å®š"],
    cp:[{n:"æ˜Ÿè¾°ç´«",d:"å¿ƒçµå…±é¸£"},{n:"ç¿¡ç¿ ç»¿",d:"ç›¸äº’æ²»æ„ˆ"},{n:"æœˆå…‰é“¶",d:"é™è°§å’Œè°"}]},
  pink:{name:"æ™šéœç²‰",em:"ğŸŒ¸",ti:"æ¸©æŸ”çš„æµªæ¼«å…±æƒ…è€…",
    co:"#EC4899",gr:"linear-gradient(135deg,#db2777,#f9a8d4)",
    gw:"rgba(236,72,153,.4)",gw2:"rgba(236,72,153,.15)",
    desc:"ä½ çš„çµé­‚åƒæ™šéœèˆ¬æ¸©æŸ”ç»šçƒ‚ï¼Œå¤©ç”Ÿæ‹¥æœ‰æ„ŸçŸ¥ä»–äººæƒ…ç»ªçš„å¤©èµ‹ã€‚ä½ ç›¸ä¿¡çˆ±æ˜¯ä¸–ç•Œä¸Šæœ€å¼ºå¤§çš„åŠ›é‡ï¼Œä½ çš„å­˜åœ¨æœ¬èº«å°±èƒ½è®©å‘¨å›´çš„äººæ„Ÿåˆ°æ¸©æš–ã€‚ä½ æ‹¥æœ‰ä¸°å¯Œçš„å†…å¿ƒä¸–ç•Œå’Œç»†è…»çš„æ„Ÿå—åŠ›ï¼Œæµªæ¼«å’Œè¯—æ„æ˜¯ä½ ç”Ÿå‘½çš„åº•è‰²ã€‚",
    tr:["å…±æƒ…åŠ›å¼º","æ¸©æŸ”ä½“è´´","æµªæ¼«ç»†è…»","å¯Œæœ‰çˆ±å¿ƒ","æ„Ÿæ€§ç›´è§‰","æƒ…æ„Ÿä¸°æ²›"],
    cp:[{n:"ç¿¡ç¿ ç»¿",d:"æ¸©æŸ”æ²»æ„ˆ"},{n:"çƒˆé˜³é‡‘",d:"äº’è¡¥å¸å¼•"},{n:"æ˜Ÿè¾°ç´«",d:"çµé­‚ç›¸æƒœ"}]},
  gold:{name:"çƒˆé˜³é‡‘",em:"â˜€ï¸",ti:"çƒ­æƒ…çš„é¢†è¢–å¼€æ‹“è€…",
    co:"#F59E0B",gr:"linear-gradient(135deg,#d97706,#fbbf24)",
    gw:"rgba(245,158,11,.4)",gw2:"rgba(245,158,11,.15)",
    desc:"ä½ çš„çµé­‚åƒæ­£åˆçš„å¤ªé˜³ä¸€æ ·ç‚½çƒ­å…‰è€€ã€‚ä½ å¤©ç”Ÿå…·æœ‰é¢†å¯¼é­…åŠ›å’Œæ„ŸæŸ“åŠ›ï¼Œèµ°åˆ°å“ªé‡Œéƒ½èƒ½æˆä¸ºç„¦ç‚¹ã€‚ä½ æœ‰è¿œå¤§çš„ç†æƒ³å’Œåšå®šçš„ä¿¡å¿µï¼Œå–„äºæ¿€åŠ±å’Œå¸¦é¢†ä»–äººã€‚ä½ ç›¸ä¿¡äººç”Ÿåº”è¯¥æ´»å¾—ç²¾å½©è€Œæœ‰æ„ä¹‰ï¼Œæ¯ä¸€å¤©éƒ½åœ¨æœç€ç›®æ ‡å…¨åŠ›å¥”è·‘ã€‚",
    tr:["é¢†å¯¼é­…åŠ›","ç›®æ ‡åšå®š","çƒ­æƒ…æ´‹æº¢","è´£ä»»å¿ƒå¼º","å–„äºæ¿€åŠ±","ç§¯æä¹è§‚"],
    cp:[{n:"èµ¤ç„°çº¢",d:"å¹¶è‚©æˆ˜æ–—"},{n:"æ™šéœç²‰",d:"æŸ”åŒ–åŠ›é‡"},{n:"ç¥ç€æ©™",d:"èƒ½é‡å…±æŒ¯"}]},
  green:{name:"ç¿¡ç¿ ç»¿",em:"ğŸŒ¿",ti:"å’Œè°çš„æ²»æ„ˆå®ˆæŠ¤è€…",
    co:"#10B981",gr:"linear-gradient(135deg,#059669,#34d399)",
    gw:"rgba(16,185,129,.4)",gw2:"rgba(16,185,129,.15)",
    desc:"ä½ çš„çµé­‚æ•£å‘ç€æ¸…æ–°çš„ç»¿è‰²å…‰èŠ’ï¼Œåƒä¸€ç‰‡ç”Ÿæœºç›ç„¶çš„æ£®æ—ã€‚ä½ å¤©ç”Ÿå…·æœ‰æ²»æ„ˆä»–äººçš„èƒ½åŠ›ï¼Œä½ çš„å­˜åœ¨è®©å‘¨å›´çš„äººæ„Ÿåˆ°å¹³é™å’Œå®‰å¿ƒã€‚ä½ é‡è§†å’Œè°çš„äººé™…å…³ç³»ï¼Œå–„äºå€¾å¬å’Œç†è§£ã€‚ä½ ç›¸ä¿¡æˆé•¿æ˜¯ç”Ÿå‘½æœ€ç¾çš„è¿‡ç¨‹ã€‚",
    tr:["æ²»æ„ˆåŠ›å¼º","å–„äºå€¾å¬","åŒ…å®¹å¤§åº¦","é‡è§†å’Œè°","è‡ªç„¶äº²å’Œ","ç¨³å®šæ¸©æš–"],
    cp:[{n:"æ™šéœç²‰",d:"æ¸©æƒ…å®ˆæŠ¤"},{n:"æ·±æµ·è“",d:"å®‰é™é™ªä¼´"},{n:"æœˆå…‰é“¶",d:"é»˜å¥‘å…±å¤„"}]},
  red:{name:"èµ¤ç„°çº¢",em:"ğŸ”¥",ti:"æ¿€æƒ…çš„å‹‡æ°”è¡ŒåŠ¨è€…",
    co:"#EF4444",gr:"linear-gradient(135deg,#dc2626,#f87171)",
    gw:"rgba(239,68,68,.4)",gw2:"rgba(239,68,68,.15)",
    desc:"ä½ çš„çµé­‚åƒç‡ƒçƒ§çš„ç«ç„°ï¼Œå……æ»¡äº†æ— ç•çš„å‹‡æ°”å’Œç‚½çƒ­çš„æ¿€æƒ…ã€‚ä½ æ˜¯å¤©ç”Ÿçš„è¡ŒåŠ¨æ´¾ï¼Œçœ‹å‡†ç›®æ ‡å°±å…¨åŠ›ä»¥èµ´ï¼Œç»ä¸é€€ç¼©ã€‚ä½ çš„èƒ½é‡å’Œæ„ŸæŸ“åŠ›æå¼ºï¼Œèƒ½åœ¨ä»»ä½•é€†å¢ƒä¸­ç‚¹ç‡ƒå¸Œæœ›ã€‚ä½ çš„äººç”Ÿä¿¡æ¡æ˜¯ï¼šä¸å…¶ç­‰å¾…ï¼Œä¸å¦‚åˆ›é€ ã€‚",
    tr:["å‹‡æ°”éå‡¡","è¡ŒåŠ¨åŠ›å¼º","çƒ­æƒ…çœŸè¯š","æ„å¿—åšå¼º","ä¿æŠ¤æ¬²å¼º","æ•¢äºæŒ‘æˆ˜"],
    cp:[{n:"çƒˆé˜³é‡‘",d:"å¼ºå¼ºè”åˆ"},{n:"ç¥ç€æ©™",d:"æ¿€æƒ…å…±ç‡ƒ"},{n:"ç¿¡ç¿ ç»¿",d:"åˆšæŸ”å¹¶æµ"}]},
  silver:{name:"æœˆå…‰é“¶",em:"ğŸŒ™",ti:"çº¯ç²¹çš„æ´å¯Ÿè§‚å¯Ÿè€…",
    co:"#D4D4D8",gr:"linear-gradient(135deg,#a1a1aa,#f4f4f5)",
    gw:"rgba(212,212,216,.3)",gw2:"rgba(212,212,216,.1)",
    desc:"ä½ çš„çµé­‚å¦‚æœˆå…‰èˆ¬æ¸…æ¾ˆçº¯ç²¹ï¼Œæ•£å‘ç€å®é™è€Œæ·±è¿œçš„é“¶è‰²å…‰è¾‰ã€‚ä½ æ˜¯å¤©ç”Ÿçš„è§‚å¯Ÿè€…ï¼Œæ‹¥æœ‰è¶…å‡¡çš„æ´å¯ŸåŠ›å’Œåˆ¤æ–­åŠ›ã€‚ä½ ä¸éœ€è¦å–§åš£æ¥è¯æ˜è‡ªå·±ï¼ŒåŠ›é‡æ¥è‡ªäºå†…å¿ƒçš„ç¬ƒå®šä¸æ¸…é†’ã€‚ä½ çš„å­˜åœ¨å¦‚åŒæš—å¤œä¸­çš„æ˜æœˆâ€”â€”ä¸è€€çœ¼ï¼Œå´èƒ½ç…§äº®æ–¹å‘ã€‚",
    tr:["æ´å¯ŸåŠ›å¼º","å†·é™å®¢è§‚","ç‹¬ç«‹æ¸…é†’","è¿½æ±‚æœ¬è´¨","å“å‘³ç‹¬ç‰¹","å†…å¿ƒåšå®š"],
    cp:[{n:"æ˜Ÿè¾°ç´«",d:"æ™ºè¯†ç¢°æ’"},{n:"æ·±æµ·è“",d:"å®é™å…±å¤„"},{n:"ç¿¡ç¿ ç»¿",d:"äº’ç›¸æ»‹å…»"}]},
  orange:{name:"ç¥ç€æ©™",em:"ğŸ§¡",ti:"æ´»åŠ›çš„åˆ›é€ å†’é™©è€…",
    co:"#FB923C",gr:"linear-gradient(135deg,#ea580c,#fdba74)",
    gw:"rgba(251,146,60,.4)",gw2:"rgba(251,146,60,.15)",
    desc:"ä½ çš„çµé­‚åƒç¥ç€ä¸€æ ·æ¸©æš–è€Œæ˜äº®ï¼Œæ•£å‘ç€æ´»åŠ›å››å°„çš„æ©™è‰²å…‰èŠ’ã€‚ä½ æ˜¯å¤©ç”Ÿçš„å†’é™©å®¶å’Œåˆ›é€ è€…ï¼Œå¯¹æ–°é²œäº‹ç‰©æ°¸è¿œå……æ»¡å¥½å¥‡ã€‚ä½ çš„ä¹è§‚å’Œå¹½é»˜æ„Ÿæå…·æ„ŸæŸ“åŠ›ï¼Œèƒ½è®©ä»»ä½•æ²‰é—·çš„åœºåˆå˜å¾—ç”ŸåŠ¨ã€‚ä½ ç›¸ä¿¡äººç”Ÿå°±æ˜¯è¦å¤šå»ä½“éªŒã€‚",
    tr:["å……æ»¡æ´»åŠ›","åˆ›é€ åŠ›å¼º","ä¹è§‚å¹½é»˜","å¥½å¥‡å¿ƒæ—º","é€‚åº”åŠ›å¼º","äº«å—å½“ä¸‹"],
    cp:[{n:"èµ¤ç„°çº¢",d:"å†’é™©æ­æ¡£"},{n:"æå…‰å½©",d:"åˆ›æ„ç¢°æ’"},{n:"çƒˆé˜³é‡‘",d:"èƒ½é‡åŠ å€"}]},
  aurora:{name:"æå…‰å½©",em:"ğŸŒŒ",ti:"å¤šå…ƒçš„è‡ªç”±æ¢¦æƒ³å®¶",
    co:"#A78BFA",gr:"linear-gradient(135deg,#a78bfa,#f9a8d4,#67e8f9)",
    gw:"rgba(167,139,250,.4)",gw2:"rgba(167,139,250,.15)",
    desc:"ä½ çš„çµé­‚åƒæå…‰ä¸€æ ·å˜å¹»è«æµ‹ã€ç»šä¸½å¤šå½©â€”â€”æ— æ³•è¢«ä»»ä½•å•ä¸€é¢œè‰²å®šä¹‰ã€‚ä½ æ‹¥æœ‰æ— é™çš„æƒ³è±¡åŠ›å’Œåˆ›é€ åŠ›ï¼Œæ€ç»´æ–¹å¼æ‰“ç ´å¸¸è§„ï¼Œæ€»èƒ½çœ‹åˆ°åˆ«äººçœ‹ä¸åˆ°çš„å¯èƒ½æ€§ã€‚ä½ è¿½æ±‚ç»å¯¹çš„è‡ªç”±å’Œè‡ªæˆ‘è¡¨è¾¾ï¼Œä½ å°±æ˜¯ä½ è‡ªå·±æœ€å¥½çš„ä½œå“ã€‚",
    tr:["æƒ³è±¡ä¸°å¯Œ","ç‰¹ç«‹ç‹¬è¡Œ","åˆ›æ„æ— é™","è¿½æ±‚è‡ªç”±","çµæ„Ÿæ•é”","ä¸å¯å®šä¹‰"],
    cp:[{n:"æ˜Ÿè¾°ç´«",d:"çµæ„Ÿæ¿€è¡"},{n:"ç¥ç€æ©™",d:"è‡ªç”±å…±èˆ"},{n:"æœˆå…‰é“¶",d:"ç›¸äº’å¯å‘"}]}
};

// â•â•â• INIT HOME COLOR SWATCHES â•â•â•
(function(){
  const keys=Object.keys(CR);
  const mk=arr=>arr.map(k=>{
    const c=CR[k];
    return `<div class="cit"><div class="csw" style="background:${c.gr}"></div><h4>${c.em} ${c.name}</h4></div>`;
  }).join('');
  document.getElementById('cgrid').innerHTML=mk(keys);
})();

// â•â•â• STATE â•â•â•
let cur=0,ans=[],busy=false;

// â•â•â• PAGE NAV with transition â•â•â•
function navTo(id){
  const old=document.querySelector('.page.active');
  if(old){
    old.classList.remove('visible');
    setTimeout(()=>{
      old.classList.remove('active');
      const pg=document.getElementById(id);
      pg.classList.add('active');
      requestAnimationFrame(()=>{
        pg.classList.add('visible');
        window.scrollTo({top:0,behavior:'instant'});
      });
      if(id==='pgHist') renderHist();
    },300);
  } else {
    const pg=document.getElementById(id);
    pg.classList.add('active');
    requestAnimationFrame(()=>pg.classList.add('visible'));
    window.scrollTo({top:0,behavior:'instant'});
  }
}

// â•â•â• QUIZ â•â•â•
function startQuiz(){cur=0;ans=[];busy=false;navTo('pgQuiz');setTimeout(renderQ,350)}

function renderQ(){
  const q=Q[cur];
  const pct=((cur)/Q.length*100).toFixed(1);
  document.getElementById('qNum').textContent=`ç¬¬ ${cur+1} é¢˜ / å…± ${Q.length} é¢˜`;
  document.getElementById('pf').style.width=Math.max(3,pct)+'%';

  let h=`<div class="qc"><h2>${q.q}</h2><div class="opts">`;
  q.o.forEach((o,i)=>{
    const pk=ans[cur]===i?'pk':'';
    h+=`<button class="op ${pk}" onclick="pick(${i})"><span class="od"></span>${o.t}</button>`;
  });
  h+=`</div></div>`;
  document.getElementById('qArea').innerHTML=h;
  document.getElementById('qNav').style.display=cur>0?'flex':'none';
  busy=false;
}

function pick(i){
  if(busy)return; // prevent double-click
  busy=true;
  ans[cur]=i;
  document.querySelectorAll('.op').forEach((b,idx)=>b.classList.toggle('pk',idx===i));
  setTimeout(()=>{
    if(cur<Q.length-1){cur++;renderQ()}
    else showLoading();
  },400);
}

function prevQ(){if(cur>0){cur--;renderQ()}}

// â•â•â• LOADING â•â•â•
function showLoading(){navTo('pgLoad');setTimeout(calcResult,2000)}

// â•â•â• CALC â•â•â•
function calcResult(){
  const sc={purple:0,blue:0,pink:0,gold:0,green:0,red:0,silver:0,orange:0,aurora:0};
  Q.forEach((q,qi)=>{const ai=ans[qi];if(ai!==undefined){const c=q.o[ai].c;for(const k in c)sc[k]=(sc[k]||0)+c[k]}});
  let mk='purple',mv=0;for(const k in sc)if(sc[k]>mv){mv=sc[k];mk=k}
  const total=Object.values(sc).reduce((a,b)=>a+b,1);
  const sorted=Object.entries(sc).sort((a,b)=>b[1]-a[1]);
  saveHist(mk,sc);
  renderResult(mk,sc,sorted,total);
  navTo('pgResult');
}

// â•â•â• RENDER RESULT â•â•â•
function renderResult(key,sc,sorted,total){
  const r=CR[key];
  const top5=sorted.slice(0,5);
  const topPct=Math.round(sorted[0][1]/total*100);

  let h=`
  <div class="rtop">
    <div class="rbadge">YOUR SOUL COLOR</div>
    <h1 style="background:${r.gr};-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text">${r.em} ${r.name}</h1>
    <div class="sub">${r.ti}</div>
  </div>
  <div class="ring-wrap"><div class="ring-box"><canvas id="ringC" width="400" height="400"></canvas>
    <div class="ring-center"><div class="ring-emoji">${r.em}</div><div class="ring-pct" style="color:${r.co}">${topPct}%</div><div class="ring-label">${r.name}</div></div>
  </div></div>

  <div class="rc"><h3>âœ¦ çµé­‚è‰²å½©è§£è¯»</h3><p>${r.desc}</p></div>

  <div class="rc"><h3>âœ¦ è‰²å½©é¢‘è°±åˆ†å¸ƒ</h3>
  ${top5.map(([k,v])=>{const cr=CR[k];const pct=Math.round(v/total*100);
    return `<div class="dg"><div class="dl"><span class="${k===key?'dlon':'dlf'}">${cr.em} ${cr.name}</span><span class="dlr">${pct}%</span></div><div class="dt"><div class="df" style="width:${pct}%;background:${cr.gr}"></div></div></div>`}).join('')}
  </div>

  <div class="rc"><h3>âœ¦ æ ¸å¿ƒæ€§æ ¼ç‰¹è´¨</h3><div class="tg">${r.tr.map(t=>`<div class="ti">${t}</div>`).join('')}</div></div>

  <div class="rc"><h3>âœ¦ çµé­‚è‰²å½©å…±é¸£</h3><p style="margin-bottom:12px;font-size:12px">ä»¥ä¸‹è‰²å½©ä¸ä½ çš„çµé­‚é¢‘ç‡æœ€ä¸ºå…±æŒ¯ï¼š</p>
    <div class="cpr">${r.cp.map(c=>`<div class="cp"><b>${c.n}</b><span>${c.d}</span></div>`).join('')}</div>
  </div>

  <div class="share-section">
    <h3>âœ¦ é•¿æŒ‰ä¿å­˜åˆ†äº«å¡ç‰‡</h3>
    <canvas id="shareCard"></canvas>
    <div class="share-tip">ğŸ’¡ é•¿æŒ‰å›¾ç‰‡ä¿å­˜ï¼Œåˆ†äº«ç»™æœ‹å‹ä¸€èµ·æµ‹è¯•å§</div>
  </div>

  <div class="racts">
    <button class="bgo" onclick="startQuiz()">âœ¦ é‡æ–°æµ‹è¯•</button>
    <button class="bgh" onclick="navTo('pgHome')">â† è¿”å›ä¸»é¡µ</button>
  </div>
  <footer>Â© 2025 Soul Spectrum Â· çµé­‚è‰²å½©æµ‹è¯•<div class="credit">â€” æµ‹è¯•ä»…ä¾›å¨±ä¹å‚è€ƒ â€”</div></footer>`;

  document.getElementById('resC').innerHTML=h;

  // Animate bars
  setTimeout(()=>{document.querySelectorAll('.df').forEach(el=>{const w=el.style.width;el.style.width='0%';setTimeout(()=>el.style.width=w,50)})},400);

  // Draw ring chart
  setTimeout(()=>drawRing(sorted,total,key),500);

  // Draw share card
  setTimeout(()=>drawShareCard(key,r,topPct,sorted,total),600);
}

// â•â•â• RING CHART â•â•â•
function drawRing(sorted,total,activeKey){
  const cv=document.getElementById('ringC');if(!cv)return;
  const ctx=cv.getContext('2d');
  const W=400,cx=W/2,cy=W/2,R=155,r=105;
  ctx.clearRect(0,0,W,W);

  let angle=-Math.PI/2;
  const colorMap={purple:'#8B5CF6',blue:'#3B82F6',pink:'#EC4899',gold:'#F59E0B',green:'#10B981',red:'#EF4444',silver:'#A1A1AA',orange:'#FB923C',aurora:'#A78BFA'};

  sorted.forEach(([k,v])=>{
    const slice=(v/total)*Math.PI*2;
    ctx.beginPath();ctx.arc(cx,cy,R,angle,angle+slice);ctx.arc(cx,cy,r,angle+slice,angle,true);ctx.closePath();
    ctx.fillStyle=k===activeKey?colorMap[k]:(colorMap[k]+'40');
    ctx.fill();
    if(k===activeKey){ctx.shadowColor=colorMap[k];ctx.shadowBlur=20;ctx.fill();ctx.shadowBlur=0}
    angle+=slice;
  });
}

// â•â•â• SHARE CARD (Canvas) â•â•â•
function drawShareCard(key,r,topPct,sorted,total){
  const cv=document.getElementById('shareCard');if(!cv)return;
  const W=840,H=1120;cv.width=W;cv.height=H;
  cv.style.width='100%';cv.style.maxWidth='420px';
  const ctx=cv.getContext('2d');

  // BG
  const bg=ctx.createLinearGradient(0,0,W,H);
  bg.addColorStop(0,'#0c0818');bg.addColorStop(.5,'#120e24');bg.addColorStop(1,'#0c0818');
  ctx.fillStyle=bg;ctx.fillRect(0,0,W,H);

  // Stars
  for(let i=0;i<80;i++){
    ctx.beginPath();ctx.arc(Math.random()*W,Math.random()*H,Math.random()*1.5+.3,0,Math.PI*2);
    ctx.fillStyle=`rgba(200,190,255,${Math.random()*.4+.1})`;ctx.fill();
  }

  // Glow circle
  const grd=ctx.createRadialGradient(W/2,320,30,W/2,320,200);
  grd.addColorStop(0,r.gw);grd.addColorStop(1,'transparent');
  ctx.fillStyle=grd;ctx.fillRect(0,120,W,400);

  // Color orb
  const orbGrd=ctx.createRadialGradient(W/2-15,300,20,W/2,320,80);
  orbGrd.addColorStop(0,r.co+'ee');orbGrd.addColorStop(1,r.co+'44');
  ctx.beginPath();ctx.arc(W/2,320,70,0,Math.PI*2);ctx.fillStyle=orbGrd;ctx.fill();

  // Orbit ring
  ctx.beginPath();ctx.arc(W/2,320,95,0,Math.PI*2);ctx.strokeStyle=r.co+'40';ctx.lineWidth=1.5;ctx.stroke();

  // Title
  ctx.textAlign='center';
  ctx.fillStyle='#ffffff90';ctx.font='500 24px "Noto Sans SC",sans-serif';
  ctx.fillText('Soul Spectrum Â· çµé­‚è‰²å½©æµ‹è¯•',W/2,120);

  // Emoji
  ctx.font='56px sans-serif';ctx.fillText(r.em,W/2,340);

  // Color name
  ctx.fillStyle='#fff';ctx.font='bold 52px "Noto Sans SC",sans-serif';
  ctx.fillText(r.name,W/2,470);

  // Subtitle
  ctx.fillStyle='#ffffffaa';ctx.font='400 26px "Noto Sans SC",sans-serif';
  ctx.fillText(r.ti,W/2,520);

  // Percentage
  ctx.fillStyle=r.co;ctx.font='bold 72px "Noto Sans SC",sans-serif';
  ctx.fillText(topPct+'%',W/2,620);
  ctx.fillStyle='#ffffff60';ctx.font='400 20px "Noto Sans SC",sans-serif';
  ctx.fillText('çµé­‚è‰²å½©åŒ¹é…åº¦',W/2,660);

  // Traits
  ctx.fillStyle='#ffffff40';ctx.font='400 20px "Noto Sans SC",sans-serif';
  ctx.fillText(r.tr.join(' Â· '),W/2,720);

  // Top 3 bars
  const top3=sorted.slice(0,3);
  const barY=780;
  const colorMapHex={purple:'#8B5CF6',blue:'#3B82F6',pink:'#EC4899',gold:'#F59E0B',green:'#10B981',red:'#EF4444',silver:'#A1A1AA',orange:'#FB923C',aurora:'#A78BFA'};

  top3.forEach(([k,v],i)=>{
    const y=barY+i*50;
    const pct=Math.round(v/total*100);
    const cr=CR[k];

    ctx.textAlign='left';ctx.fillStyle='#ffffffaa';ctx.font='400 18px "Noto Sans SC",sans-serif';
    ctx.fillText(`${cr.em} ${cr.name}`,120,y+4);

    ctx.textAlign='right';ctx.fillStyle='#ffffff80';ctx.font='400 16px "Noto Sans SC",sans-serif';
    ctx.fillText(pct+'%',W-120,y+4);

    // Bar bg
    ctx.fillStyle='#ffffff10';
    roundRect(ctx,120,y+14,600,8,4);ctx.fill();
    // Bar fill
    ctx.fillStyle=colorMapHex[k]||'#8B5CF6';
    roundRect(ctx,120,y+14,600*(pct/100),8,4);ctx.fill();
  });

  // Footer
  ctx.textAlign='center';ctx.fillStyle='#ffffff30';ctx.font='400 18px "Noto Sans SC",sans-serif';
  ctx.fillText('æ‰«ç æˆ–æœç´¢ã€Œçµé­‚è‰²å½©æµ‹è¯•ã€ä¸€èµ·æ¥æµ‹',W/2,1020);

  ctx.fillStyle='#ffffff18';ctx.font='400 14px "Noto Sans SC",sans-serif';
  ctx.fillText('Soul Spectrum Â© 2025',W/2,1070);
}

function roundRect(ctx,x,y,w,h,r){
  ctx.beginPath();ctx.moveTo(x+r,y);ctx.lineTo(x+w-r,y);ctx.quadraticCurveTo(x+w,y,x+w,y+r);
  ctx.lineTo(x+w,y+h-r);ctx.quadraticCurveTo(x+w,y+h,x+w-r,y+h);ctx.lineTo(x+r,y+h);
  ctx.quadraticCurveTo(x,y+h,x,y+h-r);ctx.lineTo(x,y+r);ctx.quadraticCurveTo(x,y,x+r,y);ctx.closePath();
}

// â•â•â• HISTORY (with fallback) â•â•â•
let histStore=[];
function getHist(){try{return JSON.parse(localStorage.getItem('soulHist')||'[]')}catch(e){return histStore}}
function setHist(h){try{localStorage.setItem('soulHist',JSON.stringify(h))}catch(e){histStore=h}}

function saveHist(key,sc){
  const h=getHist();
  h.unshift({key,name:CR[key].name,em:CR[key].em,ti:CR[key].ti,co:CR[key].co,date:new Date().toLocaleString('zh-CN'),sc});
  if(h.length>20)h.length=20;setHist(h);
}

function renderHist(){
  const h=getHist(),el=document.getElementById('hList');
  if(!h.length){el.innerHTML=`<div class="eh"><div class="ehi">ğŸŒ‘</div><p>è¿˜æ²¡æœ‰æµ‹è¯•è®°å½•<br>å¿«å»æ¢ç´¢ä½ çš„çµé­‚è‰²å½©å§</p></div>`;return}
  el.innerHTML=h.map((x,i)=>`<div class="hi" onclick="replayH(${i})"><div class="hin"><h3>${x.em} ${x.name} Â· ${x.ti}</h3><p>${x.date}</p></div><div class="hit" style="color:${x.co};border-color:${x.co}30">${x.name}</div></div>`).join('');
}

function replayH(i){
  const h=getHist()[i];if(!h)return;
  const total=Object.values(h.sc).reduce((a,b)=>a+b,1);
  const sorted=Object.entries(h.sc).sort((a,b)=>b[1]-a[1]);
  renderResult(h.key,h.sc,sorted,total);navTo('pgResult');
}

function clearHist(){if(confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•å—ï¼Ÿ')){setHist([]);renderHist()}}
</script>
</body>
</html>
